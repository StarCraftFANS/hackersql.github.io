##xpath注入之利用../回溯符遍历根目录

在文件路径中，有一个双点标记（..）指向父目录。例如，路径`/usr/sbin /sshd`也可以表示为`/etc/../usr/bin/../sbin/sshd`或许多其他变体。路径遍历攻击经常利用它在文件树中向上遍历并从更广泛的上下文访问内容。该标记在XPath中也可用。因此，我们可以使用XPath查询返回一组非常具体的结果，并使用父目录标记返回更宽的集合。我们的原始查询如下所示：

/xmlfile/users/user[username='jsmiley']/OUR_INPUT_HERE

首先，我们有一个非常具体的背景。我们可以为用户'jsmiley'选择一组子节点中的任何字段。除非我们使用路径遍历技术！需要注意的一件重要事情是，在正常的路径遍历攻击下，我们可以通过在其上使用一个`../`来制作一条有效的路径，而额外的标记只是被丢弃。 XPath并非如此，我们需要完全正确的编号。

因此，如果我们不知道查询开始，我们可以简单地蛮力，尝试一个标记，然后两个，然后三个，每次都以星号结尾，以返回所有节点：

```
../*
../../*
../../../*
```

一旦我们停止接收结果，我们知道我们已经走得太远了，并且遍历了文档的根源。所以，一个正确的答案是：

`../../../*`